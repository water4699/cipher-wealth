{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///E:/Spring/Zama/huangchen/cipher-wealth-main/cipher-wealth-main/frontend/fhevm/internal/constants.ts"],"sourcesContent":["export const SDK_CDN_URL =\n  \"https://cdn.zama.ai/relayer-sdk-js/0.2.0/relayer-sdk-js.umd.cjs\";\n"],"names":[],"mappings":";;;;AAAO,MAAM,cACX","debugId":null}},
    {"offset": {"line": 13, "column": 0}, "map": {"version":3,"sources":["file:///E:/Spring/Zama/huangchen/cipher-wealth-main/cipher-wealth-main/frontend/fhevm/internal/RelayerSDKLoader.ts"],"sourcesContent":["import { FhevmRelayerSDKType, FhevmWindowType } from \"./fhevmTypes\";\nimport { SDK_CDN_URL } from \"./constants\";\n\ntype TraceType = (message?: unknown, ...optionalParams: unknown[]) => void;\n\nexport class RelayerSDKLoader {\n  private _trace?: TraceType;\n\n  constructor(options: { trace?: TraceType }) {\n    this._trace = options.trace;\n  }\n\n  public isLoaded() {\n    if (typeof window === \"undefined\") {\n      throw new Error(\"RelayerSDKLoader: can only be used in the browser.\");\n    }\n    return isFhevmWindowType(window, this._trace);\n  }\n\n  public load(): Promise<void> {\n    console.log(\"[RelayerSDKLoader] load...\");\n    // Ensure this only runs in the browser\n    if (typeof window === \"undefined\") {\n      console.log(\"[RelayerSDKLoader] window === undefined\");\n      return Promise.reject(\n        new Error(\"RelayerSDKLoader: can only be used in the browser.\")\n      );\n    }\n\n    if (\"relayerSDK\" in window) {\n      if (!isFhevmRelayerSDKType(window.relayerSDK, this._trace)) {\n        console.log(\"[RelayerSDKLoader] window.relayerSDK === undefined\");\n        throw new Error(\"RelayerSDKLoader: Unable to load FHEVM Relayer SDK\");\n      }\n      return Promise.resolve();\n    }\n\n    return new Promise((resolve, reject) => {\n      const existingScript = document.querySelector(\n        `script[src=\"${SDK_CDN_URL}\"]`\n      );\n      if (existingScript) {\n        if (!isFhevmWindowType(window, this._trace)) {\n          reject(\n            new Error(\n              \"RelayerSDKLoader: window object does not contain a valid relayerSDK object.\"\n            )\n          );\n        }\n        resolve();\n        return;\n      }\n\n      const script = document.createElement(\"script\");\n      script.src = SDK_CDN_URL;\n      script.type = \"text/javascript\";\n      script.async = true;\n\n      script.onload = () => {\n        if (!isFhevmWindowType(window, this._trace)) {\n          console.log(\"[RelayerSDKLoader] script onload FAILED...\");\n          reject(\n            new Error(\n              `RelayerSDKLoader: Relayer SDK script has been successfully loaded from ${SDK_CDN_URL}, however, the window.relayerSDK object is invalid.`\n            )\n          );\n        }\n        resolve();\n      };\n\n      script.onerror = () => {\n        console.log(\"[RelayerSDKLoader] script onerror... \");\n        reject(\n          new Error(\n            `RelayerSDKLoader: Failed to load Relayer SDK from ${SDK_CDN_URL}`\n          )\n        );\n      };\n\n      console.log(\"[RelayerSDKLoader] add script to DOM...\");\n      document.head.appendChild(script);\n      console.log(\"[RelayerSDKLoader] script added!\")\n    });\n  }\n}\n\nfunction isFhevmRelayerSDKType(\n  o: unknown,\n  trace?: TraceType\n): o is FhevmRelayerSDKType {\n  if (typeof o === \"undefined\") {\n    trace?.(\"RelayerSDKLoader: relayerSDK is undefined\");\n    return false;\n  }\n  if (o === null) {\n    trace?.(\"RelayerSDKLoader: relayerSDK is null\");\n    return false;\n  }\n  if (typeof o !== \"object\") {\n    trace?.(\"RelayerSDKLoader: relayerSDK is not an object\");\n    return false;\n  }\n  if (!objHasProperty(o, \"initSDK\", \"function\", trace)) {\n    trace?.(\"RelayerSDKLoader: relayerSDK.initSDK is invalid\");\n    return false;\n  }\n  if (!objHasProperty(o, \"createInstance\", \"function\", trace)) {\n    trace?.(\"RelayerSDKLoader: relayerSDK.createInstance is invalid\");\n    return false;\n  }\n  if (!objHasProperty(o, \"SepoliaConfig\", \"object\", trace)) {\n    trace?.(\"RelayerSDKLoader: relayerSDK.SepoliaConfig is invalid\");\n    return false;\n  }\n  if (\"__initialized__\" in o) {\n    if (o.__initialized__ !== true && o.__initialized__ !== false) {\n      trace?.(\"RelayerSDKLoader: relayerSDK.__initialized__ is invalid\");\n      return false;\n    }\n  }\n  return true;\n}\n\nexport function isFhevmWindowType(\n  win: unknown,\n  trace?: TraceType\n): win is FhevmWindowType {\n  if (typeof win === \"undefined\") {\n    trace?.(\"RelayerSDKLoader: window object is undefined\");\n    return false;\n  }\n  if (win === null) {\n    trace?.(\"RelayerSDKLoader: window object is null\");\n    return false;\n  }\n  if (typeof win !== \"object\") {\n    trace?.(\"RelayerSDKLoader: window is not an object\");\n    return false;\n  }\n  if (!(\"relayerSDK\" in win)) {\n    trace?.(\"RelayerSDKLoader: window does not contain 'relayerSDK' property\");\n    return false;\n  }\n  return isFhevmRelayerSDKType(win.relayerSDK);\n}\n\nfunction objHasProperty<\n  T extends object,\n  K extends PropertyKey,\n  V extends string // \"string\", \"number\", etc.\n>(\n  obj: T,\n  propertyName: K,\n  propertyType: V,\n  trace?: TraceType\n): obj is T &\n  Record<\n    K,\n    V extends \"string\"\n      ? string\n      : V extends \"number\"\n      ? number\n      : V extends \"object\"\n      ? object\n      : V extends \"boolean\"\n      ? boolean\n      : V extends \"function\"\n      ? // eslint-disable-next-line @typescript-eslint/no-explicit-any\n        (...args: any[]) => any\n      : unknown\n  > {\n  if (!obj || typeof obj !== \"object\") {\n    return false;\n  }\n\n  if (!(propertyName in obj)) {\n    trace?.(`RelayerSDKLoader: missing ${String(propertyName)}.`);\n    return false;\n  }\n\n  const value = (obj as Record<K, unknown>)[propertyName];\n\n  if (value === null || value === undefined) {\n    trace?.(`RelayerSDKLoader: ${String(propertyName)} is null or undefined.`);\n    return false;\n  }\n\n  if (typeof value !== propertyType) {\n    trace?.(\n      `RelayerSDKLoader: ${String(propertyName)} is not a ${propertyType}.`\n    );\n    return false;\n  }\n\n  return true;\n}\n"],"names":[],"mappings":";;;;;;AACA;;AAIO,MAAM;IACH,OAAmB;IAE3B,YAAY,OAA8B,CAAE;QAC1C,IAAI,CAAC,MAAM,GAAG,QAAQ,KAAK;IAC7B;IAEO,WAAW;QAChB,wCAAmC;YACjC,MAAM,IAAI,MAAM;QAClB;QACA,OAAO,kBAAkB,QAAQ,IAAI,CAAC,MAAM;IAC9C;IAEO,OAAsB;QAC3B,QAAQ,GAAG,CAAC;QACZ,uCAAuC;QACvC,wCAAmC;YACjC,QAAQ,GAAG,CAAC;YACZ,OAAO,QAAQ,MAAM,CACnB,IAAI,MAAM;QAEd;;;IAwDF;AACF;AAEA,SAAS,sBACP,CAAU,EACV,KAAiB;IAEjB,IAAI,OAAO,MAAM,aAAa;QAC5B,QAAQ;QACR,OAAO;IACT;IACA,IAAI,MAAM,MAAM;QACd,QAAQ;QACR,OAAO;IACT;IACA,IAAI,OAAO,MAAM,UAAU;QACzB,QAAQ;QACR,OAAO;IACT;IACA,IAAI,CAAC,eAAe,GAAG,WAAW,YAAY,QAAQ;QACpD,QAAQ;QACR,OAAO;IACT;IACA,IAAI,CAAC,eAAe,GAAG,kBAAkB,YAAY,QAAQ;QAC3D,QAAQ;QACR,OAAO;IACT;IACA,IAAI,CAAC,eAAe,GAAG,iBAAiB,UAAU,QAAQ;QACxD,QAAQ;QACR,OAAO;IACT;IACA,IAAI,qBAAqB,GAAG;QAC1B,IAAI,EAAE,eAAe,KAAK,QAAQ,EAAE,eAAe,KAAK,OAAO;YAC7D,QAAQ;YACR,OAAO;QACT;IACF;IACA,OAAO;AACT;AAEO,SAAS,kBACd,GAAY,EACZ,KAAiB;IAEjB,IAAI,OAAO,QAAQ,aAAa;QAC9B,QAAQ;QACR,OAAO;IACT;IACA,IAAI,QAAQ,MAAM;QAChB,QAAQ;QACR,OAAO;IACT;IACA,IAAI,OAAO,QAAQ,UAAU;QAC3B,QAAQ;QACR,OAAO;IACT;IACA,IAAI,CAAC,CAAC,gBAAgB,GAAG,GAAG;QAC1B,QAAQ;QACR,OAAO;IACT;IACA,OAAO,sBAAsB,IAAI,UAAU;AAC7C;AAEA,SAAS,eAKP,GAAM,EACN,YAAe,EACf,YAAe,EACf,KAAiB;IAiBjB,IAAI,CAAC,OAAO,OAAO,QAAQ,UAAU;QACnC,OAAO;IACT;IAEA,IAAI,CAAC,CAAC,gBAAgB,GAAG,GAAG;QAC1B,QAAQ,CAAC,0BAA0B,EAAE,OAAO,cAAc,CAAC,CAAC;QAC5D,OAAO;IACT;IAEA,MAAM,QAAQ,AAAC,GAA0B,CAAC,aAAa;IAEvD,IAAI,UAAU,QAAQ,UAAU,WAAW;QACzC,QAAQ,CAAC,kBAAkB,EAAE,OAAO,cAAc,sBAAsB,CAAC;QACzE,OAAO;IACT;IAEA,IAAI,OAAO,UAAU,cAAc;QACjC,QACE,CAAC,kBAAkB,EAAE,OAAO,cAAc,UAAU,EAAE,aAAa,CAAC,CAAC;QAEvE,OAAO;IACT;IAEA,OAAO;AACT","debugId":null}},
    {"offset": {"line": 118, "column": 0}, "map": {"version":3,"sources":["file:///E:/Spring/Zama/huangchen/cipher-wealth-main/cipher-wealth-main/frontend/fhevm/internal/PublicKeyStorage.ts"],"sourcesContent":["import { openDB, DBSchema, IDBPDatabase } from \"idb\";\n\ntype FhevmStoredPublicKey = {\n  publicKeyId: string;\n  publicKey: Uint8Array;\n};\n\ntype FhevmStoredPublicParams = {\n  publicParamsId: string;\n  publicParams: Uint8Array;\n};\n\ninterface PublicParamsDB extends DBSchema {\n  publicKeyStore: {\n    key: string;\n    value: {\n      acl: `0x${string}`;\n      value: FhevmStoredPublicKey;\n    };\n  };\n  paramsStore: {\n    key: string;\n    value: {\n      acl: `0x${string}`;\n      value: FhevmStoredPublicParams;\n    };\n  };\n}\n\nlet __dbPromise: Promise<IDBPDatabase<PublicParamsDB>> | undefined = undefined;\n\nasync function _getDB(): Promise<IDBPDatabase<PublicParamsDB> | undefined> {\n  if (__dbPromise) {\n    return __dbPromise;\n  }\n  if (typeof window === \"undefined\") {\n    return undefined;\n  }\n  __dbPromise = openDB<PublicParamsDB>(\"fhevm\", 1, {\n    upgrade(db) {\n      if (!db.objectStoreNames.contains(\"paramsStore\")) {\n        db.createObjectStore(\"paramsStore\", { keyPath: \"acl\" });\n      }\n      if (!db.objectStoreNames.contains(\"publicKeyStore\")) {\n        db.createObjectStore(\"publicKeyStore\", { keyPath: \"acl\" });\n      }\n    },\n  });\n  return __dbPromise;\n}\n\ntype FhevmInstanceConfigPublicKey = {\n  data: Uint8Array | null;\n  id: string | null;\n};\n\ntype FhevmInstanceConfigPublicParams = {\n  \"2048\": {\n    publicParamsId: string;\n    publicParams: Uint8Array;\n  };\n};\n\nfunction assertFhevmStoredPublicKey(\n  value: unknown\n): asserts value is FhevmStoredPublicKey | null {\n  if (typeof value !== \"object\") {\n    throw new Error(`FhevmStoredPublicKey must be an object`);\n  }\n  if (value === null) {\n    return;\n  }\n  if (!(\"publicKeyId\" in value)) {\n    throw new Error(`FhevmStoredPublicKey.publicKeyId does not exist`);\n  }\n  if (typeof value.publicKeyId !== \"string\") {\n    throw new Error(`FhevmStoredPublicKey.publicKeyId must be a string`);\n  }\n  if (!(\"publicKey\" in value)) {\n    throw new Error(`FhevmStoredPublicKey.publicKey does not exist`);\n  }\n  if (!(value.publicKey instanceof Uint8Array)) {\n    throw new Error(`FhevmStoredPublicKey.publicKey must be a Uint8Array`);\n  }\n}\n\nfunction assertFhevmStoredPublicParams(\n  value: unknown\n): asserts value is FhevmStoredPublicParams | null {\n  if (typeof value !== \"object\") {\n    throw new Error(`FhevmStoredPublicParams must be an object`);\n  }\n  if (value === null) {\n    return;\n  }\n  if (!(\"publicParamsId\" in value)) {\n    throw new Error(`FhevmStoredPublicParams.publicParamsId does not exist`);\n  }\n  if (typeof value.publicParamsId !== \"string\") {\n    throw new Error(`FhevmStoredPublicParams.publicParamsId must be a string`);\n  }\n  if (!(\"publicParams\" in value)) {\n    throw new Error(`FhevmStoredPublicParams.publicParams does not exist`);\n  }\n  if (!(value.publicParams instanceof Uint8Array)) {\n    throw new Error(\n      `FhevmStoredPublicParams.publicParams must be a Uint8Array`\n    );\n  }\n}\n\nexport async function publicKeyStorageGet(aclAddress: `0x${string}`): Promise<{\n  publicKey?: FhevmInstanceConfigPublicKey;\n  publicParams: FhevmInstanceConfigPublicParams | null;\n}> {\n  const db = await _getDB();\n  if (!db) {\n    return { publicParams: null };\n  }\n\n  let storedPublicKey: FhevmStoredPublicKey | null = null;\n  try {\n    const pk = await db.get(\"publicKeyStore\", aclAddress);\n    if (pk?.value) {\n      assertFhevmStoredPublicKey(pk.value);\n      storedPublicKey = pk.value;\n    }\n  } catch {\n    //\n  }\n\n  let storedPublicParams: FhevmStoredPublicParams | null = null;\n  try {\n    const pp = await db.get(\"paramsStore\", aclAddress);\n    if (pp?.value) {\n      assertFhevmStoredPublicParams(pp.value);\n      storedPublicParams = pp.value;\n    }\n  } catch {\n    //\n  }\n\n  const publicKeyData = storedPublicKey?.publicKey;\n  const publicKeyId = storedPublicKey?.publicKeyId;\n  const publicParams = storedPublicParams\n    ? {\n        \"2048\": storedPublicParams,\n      }\n    : null;\n\n  let publicKey: FhevmInstanceConfigPublicKey | undefined = undefined;\n\n  if (publicKeyId && publicKeyData) {\n    publicKey = {\n      id: publicKeyId,\n      data: publicKeyData,\n    };\n  }\n\n  return {\n    ...(publicKey !== undefined && { publicKey }),\n    publicParams,\n  };\n}\n\nexport async function publicKeyStorageSet(\n  aclAddress: `0x${string}`,\n  publicKey: FhevmStoredPublicKey | null,\n  publicParams: FhevmStoredPublicParams | null\n) {\n  assertFhevmStoredPublicKey(publicKey);\n  assertFhevmStoredPublicParams(publicParams);\n\n  const db = await _getDB();\n  if (!db) {\n    return;\n  }\n\n  if (publicKey) {\n    await db.put(\"publicKeyStore\", { acl: aclAddress, value: publicKey });\n  }\n\n  if (publicParams) {\n    await db.put(\"paramsStore\", { acl: aclAddress, value: publicParams });\n  }\n}\n"],"names":[],"mappings":";;;;;;AAAA;;AA6BA,IAAI,cAAiE;AAErE,eAAe;IACb,IAAI,aAAa;QACf,OAAO;IACT;IACA,wCAAmC;QACjC,OAAO;IACT;;;AAYF;AAcA,SAAS,2BACP,KAAc;IAEd,IAAI,OAAO,UAAU,UAAU;QAC7B,MAAM,IAAI,MAAM,CAAC,sCAAsC,CAAC;IAC1D;IACA,IAAI,UAAU,MAAM;QAClB;IACF;IACA,IAAI,CAAC,CAAC,iBAAiB,KAAK,GAAG;QAC7B,MAAM,IAAI,MAAM,CAAC,+CAA+C,CAAC;IACnE;IACA,IAAI,OAAO,MAAM,WAAW,KAAK,UAAU;QACzC,MAAM,IAAI,MAAM,CAAC,iDAAiD,CAAC;IACrE;IACA,IAAI,CAAC,CAAC,eAAe,KAAK,GAAG;QAC3B,MAAM,IAAI,MAAM,CAAC,6CAA6C,CAAC;IACjE;IACA,IAAI,CAAC,CAAC,MAAM,SAAS,YAAY,UAAU,GAAG;QAC5C,MAAM,IAAI,MAAM,CAAC,mDAAmD,CAAC;IACvE;AACF;AAEA,SAAS,8BACP,KAAc;IAEd,IAAI,OAAO,UAAU,UAAU;QAC7B,MAAM,IAAI,MAAM,CAAC,yCAAyC,CAAC;IAC7D;IACA,IAAI,UAAU,MAAM;QAClB;IACF;IACA,IAAI,CAAC,CAAC,oBAAoB,KAAK,GAAG;QAChC,MAAM,IAAI,MAAM,CAAC,qDAAqD,CAAC;IACzE;IACA,IAAI,OAAO,MAAM,cAAc,KAAK,UAAU;QAC5C,MAAM,IAAI,MAAM,CAAC,uDAAuD,CAAC;IAC3E;IACA,IAAI,CAAC,CAAC,kBAAkB,KAAK,GAAG;QAC9B,MAAM,IAAI,MAAM,CAAC,mDAAmD,CAAC;IACvE;IACA,IAAI,CAAC,CAAC,MAAM,YAAY,YAAY,UAAU,GAAG;QAC/C,MAAM,IAAI,MACR,CAAC,yDAAyD,CAAC;IAE/D;AACF;AAEO,eAAe,oBAAoB,UAAyB;IAIjE,MAAM,KAAK,MAAM;IACjB,IAAI,CAAC,IAAI;QACP,OAAO;YAAE,cAAc;QAAK;IAC9B;IAEA,IAAI,kBAA+C;IACnD,IAAI;QACF,MAAM,KAAK,MAAM,GAAG,GAAG,CAAC,kBAAkB;QAC1C,IAAI,IAAI,OAAO;YACb,2BAA2B,GAAG,KAAK;YACnC,kBAAkB,GAAG,KAAK;QAC5B;IACF,EAAE,OAAM;IACN,EAAE;IACJ;IAEA,IAAI,qBAAqD;IACzD,IAAI;QACF,MAAM,KAAK,MAAM,GAAG,GAAG,CAAC,eAAe;QACvC,IAAI,IAAI,OAAO;YACb,8BAA8B,GAAG,KAAK;YACtC,qBAAqB,GAAG,KAAK;QAC/B;IACF,EAAE,OAAM;IACN,EAAE;IACJ;IAEA,MAAM,gBAAgB,iBAAiB;IACvC,MAAM,cAAc,iBAAiB;IACrC,MAAM,eAAe,qBACjB;QACE,QAAQ;IACV,IACA;IAEJ,IAAI,YAAsD;IAE1D,IAAI,eAAe,eAAe;QAChC,YAAY;YACV,IAAI;YACJ,MAAM;QACR;IACF;IAEA,OAAO;QACL,GAAI,cAAc,aAAa;YAAE;QAAU,CAAC;QAC5C;IACF;AACF;AAEO,eAAe,oBACpB,UAAyB,EACzB,SAAsC,EACtC,YAA4C;IAE5C,2BAA2B;IAC3B,8BAA8B;IAE9B,MAAM,KAAK,MAAM;IACjB,IAAI,CAAC,IAAI;QACP;IACF;IAEA,IAAI,WAAW;QACb,MAAM,GAAG,GAAG,CAAC,kBAAkB;YAAE,KAAK;YAAY,OAAO;QAAU;IACrE;IAEA,IAAI,cAAc;QAChB,MAAM,GAAG,GAAG,CAAC,eAAe;YAAE,KAAK;YAAY,OAAO;QAAa;IACrE;AACF","debugId":null}},
    {"offset": {"line": 247, "column": 0}, "map": {"version":3,"sources":["file:///E:/Spring/Zama/huangchen/cipher-wealth-main/cipher-wealth-main/frontend/fhevm/internal/fhevm.ts"],"sourcesContent":["import { isAddress, Eip1193Provider, JsonRpcProvider } from \"ethers\";\nimport type {\n  FhevmInitSDKOptions,\n  FhevmInitSDKType,\n  FhevmLoadSDKType,\n  FhevmWindowType,\n} from \"./fhevmTypes\";\nimport { isFhevmWindowType, RelayerSDKLoader } from \"./RelayerSDKLoader\";\nimport { publicKeyStorageGet, publicKeyStorageSet } from \"./PublicKeyStorage\";\nimport { FhevmInstance, FhevmInstanceConfig } from \"../fhevmTypes\";\n\nexport class FhevmReactError extends Error {\n  code: string;\n  constructor(code: string, message?: string, options?: ErrorOptions) {\n    super(message, options);\n    this.code = code;\n    this.name = \"FhevmReactError\";\n  }\n}\n\nfunction throwFhevmError(\n  code: string,\n  message?: string,\n  cause?: unknown\n): never {\n  throw new FhevmReactError(code, message, cause ? { cause } : undefined);\n}\n\nconst isFhevmInitialized = (): boolean => {\n  if (!isFhevmWindowType(window, console.log)) {\n    return false;\n  }\n  return window.relayerSDK.__initialized__ === true;\n};\n\nconst fhevmLoadSDK: FhevmLoadSDKType = () => {\n  const loader = new RelayerSDKLoader({ trace: console.log });\n  return loader.load();\n};\n\nconst fhevmInitSDK: FhevmInitSDKType = async (\n  options?: FhevmInitSDKOptions\n) => {\n  if (!isFhevmWindowType(window, console.log)) {\n    throw new Error(\"window.relayerSDK is not available\");\n  }\n  const result = await window.relayerSDK.initSDK(options);\n  window.relayerSDK.__initialized__ = result;\n  if (!result) {\n    throw new Error(\"window.relayerSDK.initSDK failed.\");\n  }\n  return true;\n};\n\nfunction checkIsAddress(a: unknown): a is `0x${string}` {\n  if (typeof a !== \"string\") {\n    return false;\n  }\n  if (!isAddress(a)) {\n    return false;\n  }\n  return true;\n}\n\nexport class FhevmAbortError extends Error {\n  constructor(message = \"FHEVM operation was cancelled\") {\n    super(message);\n    this.name = \"FhevmAbortError\";\n  }\n}\n\ntype FhevmRelayerStatusType =\n  | \"sdk-loading\"\n  | \"sdk-loaded\"\n  | \"sdk-initializing\"\n  | \"sdk-initialized\"\n  | \"creating\";\n\nasync function getChainId(\n  providerOrUrl: Eip1193Provider | string\n): Promise<number> {\n  if (typeof providerOrUrl === \"string\") {\n    const provider = new JsonRpcProvider(providerOrUrl);\n    return Number((await provider.getNetwork()).chainId);\n  }\n  const chainId = await providerOrUrl.request({ method: \"eth_chainId\" });\n  return Number.parseInt(chainId as string, 16);\n}\n\nasync function getWeb3Client(rpcUrl: string) {\n  const rpc = new JsonRpcProvider(rpcUrl);\n  try {\n    const version = await rpc.send(\"web3_clientVersion\", []);\n    return version;\n  } catch (e) {\n    throwFhevmError(\n      \"WEB3_CLIENTVERSION_ERROR\",\n      `The URL ${rpcUrl} is not a Web3 node or is not reachable. Please check the endpoint.`,\n      e\n    );\n  } finally {\n    rpc.destroy();\n  }\n}\n\nasync function tryFetchFHEVMHardhatNodeRelayerMetadata(rpcUrl: string): Promise<\n  | {\n      ACLAddress: `0x${string}`;\n      InputVerifierAddress: `0x${string}`;\n      KMSVerifierAddress: `0x${string}`;\n    }\n  | undefined\n> {\n  const version = await getWeb3Client(rpcUrl);\n  if (\n    typeof version !== \"string\" ||\n    !version.toLowerCase().includes(\"hardhat\")\n  ) {\n    // Not a Hardhat Node\n    return undefined;\n  }\n  try {\n    const metadata = await getFHEVMRelayerMetadata(rpcUrl);\n    if (!metadata || typeof metadata !== \"object\") {\n      return undefined;\n    }\n    if (\n      !(\n        \"ACLAddress\" in metadata &&\n        typeof metadata.ACLAddress === \"string\" &&\n        metadata.ACLAddress.startsWith(\"0x\")\n      )\n    ) {\n      return undefined;\n    }\n    if (\n      !(\n        \"InputVerifierAddress\" in metadata &&\n        typeof metadata.InputVerifierAddress === \"string\" &&\n        metadata.InputVerifierAddress.startsWith(\"0x\")\n      )\n    ) {\n      return undefined;\n    }\n    if (\n      !(\n        \"KMSVerifierAddress\" in metadata &&\n        typeof metadata.KMSVerifierAddress === \"string\" &&\n        metadata.KMSVerifierAddress.startsWith(\"0x\")\n      )\n    ) {\n      return undefined;\n    }\n    return metadata;\n  } catch {\n    // Not a FHEVM Hardhat Node\n    return undefined;\n  }\n}\n\nasync function getFHEVMRelayerMetadata(rpcUrl: string) {\n  const rpc = new JsonRpcProvider(rpcUrl);\n  try {\n    const version = await rpc.send(\"fhevm_relayer_metadata\", []);\n    return version;\n  } catch (e) {\n    throwFhevmError(\n      \"FHEVM_RELAYER_METADATA_ERROR\",\n      `The URL ${rpcUrl} is not a FHEVM Hardhat node or is not reachable. Please check the endpoint.`,\n      e\n    );\n  } finally {\n    rpc.destroy();\n  }\n}\n\ntype MockResolveResult = { isMock: true; chainId: number; rpcUrl: string };\ntype GenericResolveResult = { isMock: false; chainId: number; rpcUrl?: string };\ntype ResolveResult = MockResolveResult | GenericResolveResult;\n\nasync function resolve(\n  providerOrUrl: Eip1193Provider | string,\n  mockChains?: Record<number, string>\n): Promise<ResolveResult> {\n  // Resolve chainId\n  const chainId = await getChainId(providerOrUrl);\n\n  // Resolve rpc url\n  let rpcUrl = typeof providerOrUrl === \"string\" ? providerOrUrl : undefined;\n\n  const _mockChains: Record<number, string> = {\n    31337: \"http://localhost:8545\",\n    ...(mockChains ?? {}),\n  };\n\n  // Help Typescript solver here:\n  if (Object.hasOwn(_mockChains, chainId)) {\n    if (!rpcUrl) {\n      rpcUrl = _mockChains[chainId];\n    }\n\n    return { isMock: true, chainId, rpcUrl };\n  }\n\n  return { isMock: false, chainId, rpcUrl };\n}\n\nexport const createFhevmInstance = async (parameters: {\n  provider: Eip1193Provider | string;\n  mockChains?: Record<number, string>;\n  signal: AbortSignal;\n  onStatusChange?: (status: FhevmRelayerStatusType) => void;\n}): Promise<FhevmInstance> => {\n  const throwIfAborted = () => {\n    if (signal.aborted) throw new FhevmAbortError();\n  };\n\n  const notify = (status: FhevmRelayerStatusType) => {\n    if (onStatusChange) onStatusChange(status);\n  };\n\n  const {\n    signal,\n    onStatusChange,\n    provider: providerOrUrl,\n    mockChains,\n  } = parameters;\n\n  // Resolve chainId\n  const { isMock, rpcUrl, chainId } = await resolve(providerOrUrl, mockChains);\n\n  if (isMock) {\n    // Throws an error if cannot connect or url does not refer to a Web3 client\n    const fhevmRelayerMetadata =\n      await tryFetchFHEVMHardhatNodeRelayerMetadata(rpcUrl);\n\n    if (fhevmRelayerMetadata) {\n      // fhevmRelayerMetadata is defined, which means rpcUrl refers to a FHEVM Hardhat Node\n      notify(\"creating\");\n\n      //////////////////////////////////////////////////////////////////////////\n      // \n      // WARNING!!\n      // ALWAY USE DYNAMIC IMPORT TO AVOID INCLUDING THE ENTIRE FHEVM MOCK LIB \n      // IN THE FINAL PRODUCTION BUNDLE!!\n      // \n      //////////////////////////////////////////////////////////////////////////\n      const fhevmMock = await import(\"./mock/fhevmMock\");\n      const mockInstance = await fhevmMock.fhevmMockCreateInstance({\n        rpcUrl,\n        chainId,\n        metadata: fhevmRelayerMetadata,\n      });\n\n      throwIfAborted();\n\n      return mockInstance;\n    }\n  }\n\n  throwIfAborted();\n\n  if (!isFhevmWindowType(window, console.log)) {\n    notify(\"sdk-loading\");\n\n    // throws an error if failed\n    await fhevmLoadSDK();\n    throwIfAborted();\n\n    notify(\"sdk-loaded\");\n  }\n\n  // notify that state === \"sdk-loaded\"\n\n  if (!isFhevmInitialized()) {\n    notify(\"sdk-initializing\");\n\n    // throws an error if failed\n    await fhevmInitSDK();\n    throwIfAborted();\n\n    notify(\"sdk-initialized\");\n  }\n\n  const relayerSDK = (window as unknown as FhevmWindowType).relayerSDK;\n\n  const aclAddress = relayerSDK.SepoliaConfig.aclContractAddress;\n  if (!checkIsAddress(aclAddress)) {\n    throw new Error(`Invalid address: ${aclAddress}`);\n  }\n\n  const pub = await publicKeyStorageGet(aclAddress);\n  throwIfAborted();\n\n  const config: FhevmInstanceConfig = {\n    ...relayerSDK.SepoliaConfig,\n    network: providerOrUrl,\n    publicKey: pub.publicKey,\n    publicParams: pub.publicParams,\n  };\n\n  // notify that state === \"creating\"\n  notify(\"creating\");\n\n  const instance = await relayerSDK.createInstance(config);\n\n  // Save the key even if aborted\n  await publicKeyStorageSet(\n    aclAddress,\n    instance.getPublicKey(),\n    instance.getPublicParams(2048)\n  );\n\n  throwIfAborted();\n\n  return instance;\n};\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 471, "column": 0}, "map": {"version":3,"sources":["file:///E:/Spring/Zama/huangchen/cipher-wealth-main/cipher-wealth-main/frontend/fhevm/useFhevm.tsx"],"sourcesContent":["import { ethers } from \"ethers\";\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport type { FhevmInstance } from \"./fhevmTypes\";\nimport { createFhevmInstance } from \"./internal/fhevm\";\n\nfunction _assert(condition: boolean, message?: string): asserts condition {\n  if (!condition) {\n    const m = message ? `Assertion failed: ${message}` : `Assertion failed.`;\n    console.error(m);\n    throw new Error(m);\n  }\n}\n\nexport type FhevmGoState = \"idle\" | \"loading\" | \"ready\" | \"error\";\n\nexport function useFhevm(parameters: {\n  provider: string | ethers.Eip1193Provider | undefined;\n  chainId: number | undefined;\n  enabled?: boolean;\n  initialMockChains?: Readonly<Record<number, string>>;  \n}): {\n  instance: FhevmInstance | undefined;\n  refresh: () => void;\n  error: Error | undefined;\n  status: FhevmGoState;\n} {\n  const { provider, chainId, initialMockChains, enabled = true } = parameters;\n\n  const [instance, _setInstance] = useState<FhevmInstance | undefined>(\n    undefined\n  );\n  const [status, _setStatus] = useState<FhevmGoState>(\"idle\");\n  const [error, _setError] = useState<Error | undefined>(undefined);\n  const [_isRunning, _setIsRunning] = useState<boolean>(enabled);\n  const [_providerChanged, _setProviderChanged] = useState<number>(0);\n  const _abortControllerRef = useRef<AbortController | null>(null);\n  const _providerRef = useRef<string | ethers.Eip1193Provider | undefined>(\n    provider\n  );\n  const _chainIdRef = useRef<number | undefined>(chainId);\n  const _mockChainsRef = useRef<Record<number, string> | undefined>(\n    initialMockChains\n  );\n\n  const refresh = useCallback(() => {\n    // Provider or chainId has changed. Abort immediately\n    if (_abortControllerRef.current) {\n      // Make sure _providerRef.current + _chainIdRef.current are undefined during abort\n      _providerRef.current = undefined;\n      _chainIdRef.current = undefined;\n\n      _abortControllerRef.current.abort();\n      _abortControllerRef.current = null;\n    }\n\n    _providerRef.current = provider;\n    _chainIdRef.current = chainId;\n\n    // Nullify instance immediately\n    _setInstance(undefined);\n    _setError(undefined);\n    _setStatus(\"idle\");\n\n    if (provider !== undefined) {\n      // Force call main useEffect\n      _setProviderChanged((prev) => prev + 1);\n    }\n\n    // Do not modify the running flag.\n  }, [provider, chainId]);\n\n  // Merge in main useEffect!!!\n  useEffect(() => {\n    refresh();\n  }, [refresh]);\n\n  useEffect(() => {\n    _setIsRunning(enabled);\n  }, [enabled]);\n\n  // Main useEffect\n  useEffect(() => {\n    // is _providerRef.current valid here ?\n    // even if the first useEffect is rendered in the same render-cycle ?\n    if (_isRunning === false) {\n      // cancelled\n      console.log(\"cancelled\");\n      if (_abortControllerRef.current) {\n        _abortControllerRef.current.abort();\n        _abortControllerRef.current = null;\n      }\n      // May already be null if provider was changed in the previous render-cycle\n      _setInstance(undefined);\n      _setError(undefined);\n      _setStatus(\"idle\");\n      return;\n    }\n\n    if (_isRunning === true) {\n      if (_providerRef.current === undefined) {\n        // instance should be undefined\n        // this code below should be unecessary\n        _setInstance(undefined);\n        _setError(undefined);\n        _setStatus(\"idle\");\n        return;\n      }\n\n      if (!_abortControllerRef.current) {\n        _abortControllerRef.current = new AbortController();\n      }\n\n      _assert(\n        !_abortControllerRef.current.signal.aborted,\n        \"!controllerRef.current.signal.aborted\"\n      );\n\n      // Keep old instance\n      // Was set to undefined if provider changed\n      _setStatus(\"loading\");\n      _setError(undefined);\n\n      const thisSignal = _abortControllerRef.current.signal;\n      const thisProvider = _providerRef.current;\n      // Can be undefined, if so, call eth_chainId\n      const thisRpcUrlsByChainId = _mockChainsRef.current;\n\n      createFhevmInstance({\n        signal: thisSignal,\n        provider: thisProvider,\n        mockChains: thisRpcUrlsByChainId,\n        onStatusChange: (s) =>\n          console.log(`[useFhevm] createFhevmInstance status changed: ${s}`),\n      })\n        .then((i) => {\n          console.log(`[useFhevm] createFhevmInstance created!`);\n          //console.log(`completed (runId=${thisRunId})...`);\n          if (thisSignal.aborted) return;\n\n          // is there a edge case where the assert below would fail ?\n          // it's not possible to have a _providerRef modified without a prior abort\n          _assert(\n            thisProvider === _providerRef.current,\n            \"thisProvider === _providerRef.current\"\n          );\n\n          _setInstance(i);\n          _setError(undefined);\n          _setStatus(\"ready\");\n        })\n        .catch((e) => {\n          console.log(`Error Was thrown !!! error... ` + e.name);\n          if (thisSignal.aborted) return;\n\n          // it's not possible to have a _providerRef modified without a prior abort\n          _assert(\n            thisProvider === _providerRef.current,\n            \"thisProvider === _providerRef.current\"\n          );\n\n          _setInstance(undefined);\n          _setError(e);\n          _setStatus(\"error\");\n        });\n    }\n  }, [_isRunning, _providerChanged]);\n\n  return { instance, refresh, error, status };\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 610, "column": 0}, "map": {"version":3,"sources":["file:///E:/Spring/Zama/huangchen/cipher-wealth-main/cipher-wealth-main/frontend/abi/CipherWealth.ts"],"sourcesContent":["\n/*\n  This file is auto-generated.\n  Command: 'node scripts/genabi-cipher.mjs'\n*/\nexport const CipherWealth = {\n  \"abi\": [\n    {\n      \"anonymous\": false,\n      \"inputs\": [\n        {\n          \"indexed\": true,\n          \"internalType\": \"address\",\n          \"name\": \"user\",\n          \"type\": \"address\"\n        }\n      ],\n      \"name\": \"Deposit\",\n      \"type\": \"event\"\n    },\n    {\n      \"anonymous\": false,\n      \"inputs\": [\n        {\n          \"indexed\": true,\n          \"internalType\": \"address\",\n          \"name\": \"user\",\n          \"type\": \"address\"\n        }\n      ],\n      \"name\": \"Withdrawal\",\n      \"type\": \"event\"\n    },\n    {\n      \"inputs\": [\n        {\n          \"internalType\": \"externalEuint64\",\n          \"name\": \"inputEuint64\",\n          \"type\": \"bytes32\"\n        },\n        {\n          \"internalType\": \"bytes\",\n          \"name\": \"inputProof\",\n          \"type\": \"bytes\"\n        }\n      ],\n      \"name\": \"deposit\",\n      \"outputs\": [],\n      \"stateMutability\": \"nonpayable\",\n      \"type\": \"function\"\n    },\n    {\n      \"inputs\": [],\n      \"name\": \"getBalance\",\n      \"outputs\": [\n        {\n          \"internalType\": \"euint64\",\n          \"name\": \"\",\n          \"type\": \"bytes32\"\n        }\n      ],\n      \"stateMutability\": \"view\",\n      \"type\": \"function\"\n    },\n    {\n      \"inputs\": [\n        {\n          \"internalType\": \"address\",\n          \"name\": \"user\",\n          \"type\": \"address\"\n        }\n      ],\n      \"name\": \"getBalanceOf\",\n      \"outputs\": [\n        {\n          \"internalType\": \"euint64\",\n          \"name\": \"\",\n          \"type\": \"bytes32\"\n        }\n      ],\n      \"stateMutability\": \"view\",\n      \"type\": \"function\"\n    },\n    {\n      \"inputs\": [],\n      \"name\": \"protocolId\",\n      \"outputs\": [\n        {\n          \"internalType\": \"uint256\",\n          \"name\": \"\",\n          \"type\": \"uint256\"\n        }\n      ],\n      \"stateMutability\": \"pure\",\n      \"type\": \"function\"\n    },\n    {\n      \"inputs\": [\n        {\n          \"internalType\": \"address\",\n          \"name\": \"to\",\n          \"type\": \"address\"\n        },\n        {\n          \"internalType\": \"externalEuint64\",\n          \"name\": \"inputEuint64\",\n          \"type\": \"bytes32\"\n        },\n        {\n          \"internalType\": \"bytes\",\n          \"name\": \"inputProof\",\n          \"type\": \"bytes\"\n        }\n      ],\n      \"name\": \"transfer\",\n      \"outputs\": [],\n      \"stateMutability\": \"nonpayable\",\n      \"type\": \"function\"\n    },\n    {\n      \"inputs\": [\n        {\n          \"internalType\": \"externalEuint64\",\n          \"name\": \"inputEuint64\",\n          \"type\": \"bytes32\"\n        },\n        {\n          \"internalType\": \"bytes\",\n          \"name\": \"inputProof\",\n          \"type\": \"bytes\"\n        }\n      ],\n      \"name\": \"withdraw\",\n      \"outputs\": [],\n      \"stateMutability\": \"nonpayable\",\n      \"type\": \"function\"\n    }\n  ]\n} as const;\n\n"],"names":[],"mappings":"AACA;;;AAGA;;;;AACO,MAAM,eAAe;IAC1B,OAAO;QACL;YACE,aAAa;YACb,UAAU;gBACR;oBACE,WAAW;oBACX,gBAAgB;oBAChB,QAAQ;oBACR,QAAQ;gBACV;aACD;YACD,QAAQ;YACR,QAAQ;QACV;QACA;YACE,aAAa;YACb,UAAU;gBACR;oBACE,WAAW;oBACX,gBAAgB;oBAChB,QAAQ;oBACR,QAAQ;gBACV;aACD;YACD,QAAQ;YACR,QAAQ;QACV;QACA;YACE,UAAU;gBACR;oBACE,gBAAgB;oBAChB,QAAQ;oBACR,QAAQ;gBACV;gBACA;oBACE,gBAAgB;oBAChB,QAAQ;oBACR,QAAQ;gBACV;aACD;YACD,QAAQ;YACR,WAAW,EAAE;YACb,mBAAmB;YACnB,QAAQ;QACV;QACA;YACE,UAAU,EAAE;YACZ,QAAQ;YACR,WAAW;gBACT;oBACE,gBAAgB;oBAChB,QAAQ;oBACR,QAAQ;gBACV;aACD;YACD,mBAAmB;YACnB,QAAQ;QACV;QACA;YACE,UAAU;gBACR;oBACE,gBAAgB;oBAChB,QAAQ;oBACR,QAAQ;gBACV;aACD;YACD,QAAQ;YACR,WAAW;gBACT;oBACE,gBAAgB;oBAChB,QAAQ;oBACR,QAAQ;gBACV;aACD;YACD,mBAAmB;YACnB,QAAQ;QACV;QACA;YACE,UAAU,EAAE;YACZ,QAAQ;YACR,WAAW;gBACT;oBACE,gBAAgB;oBAChB,QAAQ;oBACR,QAAQ;gBACV;aACD;YACD,mBAAmB;YACnB,QAAQ;QACV;QACA;YACE,UAAU;gBACR;oBACE,gBAAgB;oBAChB,QAAQ;oBACR,QAAQ;gBACV;gBACA;oBACE,gBAAgB;oBAChB,QAAQ;oBACR,QAAQ;gBACV;gBACA;oBACE,gBAAgB;oBAChB,QAAQ;oBACR,QAAQ;gBACV;aACD;YACD,QAAQ;YACR,WAAW,EAAE;YACb,mBAAmB;YACnB,QAAQ;QACV;QACA;YACE,UAAU;gBACR;oBACE,gBAAgB;oBAChB,QAAQ;oBACR,QAAQ;gBACV;gBACA;oBACE,gBAAgB;oBAChB,QAAQ;oBACR,QAAQ;gBACV;aACD;YACD,QAAQ;YACR,WAAW,EAAE;YACb,mBAAmB;YACnB,QAAQ;QACV;KACD;AACH","debugId":null}},
    {"offset": {"line": 755, "column": 0}, "map": {"version":3,"sources":["file:///E:/Spring/Zama/huangchen/cipher-wealth-main/cipher-wealth-main/frontend/abi/CipherWealthAddresses.ts"],"sourcesContent":["\n/*\n  This file is auto-generated.\n  Command: 'node scripts/genabi-cipher.mjs'\n*/\nexport const CipherWealthAddresses = { \n  \"11155111\": { address: \"0x0000000000000000000000000000000000000000\", chainId: 11155111, chainName: \"sepolia\" },\n  \"31337\": { address: \"0xe7f1725E7734CE288F8367e1Bb143E90bb3F0512\", chainId: 31337, chainName: \"hardhat\" },\n};\n"],"names":[],"mappings":"AACA;;;AAGA;;;;AACO,MAAM,wBAAwB;IACnC,YAAY;QAAE,SAAS;QAA8C,SAAS;QAAU,WAAW;IAAU;IAC7G,SAAS;QAAE,SAAS;QAA8C,SAAS;QAAO,WAAW;IAAU;AACzG","debugId":null}},
    {"offset": {"line": 778, "column": 0}, "map": {"version":3,"sources":["file:///E:/Spring/Zama/huangchen/cipher-wealth-main/cipher-wealth-main/frontend/fhevm/FhevmDecryptionSignature.ts"],"sourcesContent":["import { ethers } from \"ethers\";\nimport {\n  EIP712Type,\n  FhevmDecryptionSignatureType,\n  FhevmInstance,\n} from \"./fhevmTypes\";\nimport { GenericStringStorage } from \"./GenericStringStorage\";\n\nfunction _timestampNow(): number {\n  return Math.floor(Date.now() / 1000);\n}\n\nclass FhevmDecryptionSignatureStorageKey {\n  #contractAddresses: `0x${string}`[];\n  #userAddress: `0x${string}`;\n  #publicKey: string | undefined;\n  #key: string;\n\n  constructor(\n    instance: FhevmInstance,\n    contractAddresses: string[],\n    userAddress: string,\n    publicKey?: string\n  ) {\n    if (!ethers.isAddress(userAddress)) {\n      throw new TypeError(`Invalid address ${userAddress}`);\n    }\n\n    const sortedContractAddresses = (\n      contractAddresses as `0x${string}`[]\n    ).sort();\n\n    const emptyEIP712 = instance.createEIP712(\n      publicKey ?? ethers.ZeroAddress,\n      sortedContractAddresses,\n      0,\n      0\n    );\n\n    try {\n      const hash = ethers.TypedDataEncoder.hash(\n        emptyEIP712.domain,\n        { UserDecryptRequestVerification: emptyEIP712.types.UserDecryptRequestVerification },\n        emptyEIP712.message\n      );\n\n      this.#contractAddresses = sortedContractAddresses;\n      this.#userAddress = userAddress as `0x${string}`;\n\n      this.#key = `${userAddress}:${hash}`;\n    } catch (e) {\n      console.log(e);\n      throw e;\n    }\n  }\n\n  get contractAddresses(): `0x${string}`[] {\n    return this.#contractAddresses;\n  }\n\n  get userAddress(): `0x${string}` {\n    return this.#userAddress;\n  }\n\n  get publicKey(): string | undefined {\n    return this.#publicKey;\n  }\n\n  get key(): string {\n    return this.#key;\n  }\n}\n\nexport class FhevmDecryptionSignature {\n  #publicKey: string;\n  #privateKey: string;\n  #signature: string;\n  #startTimestamp: number; // Unix timestamp in seconds\n  #durationDays: number;\n  #userAddress: `0x${string}`;\n  #contractAddresses: `0x${string}`[];\n  #eip712: EIP712Type;\n\n  private constructor(parameters: FhevmDecryptionSignatureType) {\n    if (!FhevmDecryptionSignature.checkIs(parameters)) {\n      throw new TypeError(\"Invalid FhevmDecryptionSignatureType\");\n    }\n    this.#publicKey = parameters.publicKey;\n    this.#privateKey = parameters.privateKey;\n    this.#signature = parameters.signature;\n    this.#startTimestamp = parameters.startTimestamp;\n    this.#durationDays = parameters.durationDays;\n    this.#userAddress = parameters.userAddress;\n    this.#contractAddresses = parameters.contractAddresses;\n    this.#eip712 = parameters.eip712;\n  }\n\n  public get privateKey() {\n    return this.#privateKey;\n  }\n\n  public get publicKey() {\n    return this.#publicKey;\n  }\n\n  public get signature() {\n    return this.#signature;\n  }\n\n  public get contractAddresses() {\n    return this.#contractAddresses;\n  }\n\n  public get startTimestamp() {\n    return this.#startTimestamp;\n  }\n\n  public get durationDays() {\n    return this.#durationDays;\n  }\n\n  public get userAddress() {\n    return this.#userAddress;\n  }\n\n  static checkIs(s: unknown): s is FhevmDecryptionSignatureType {\n    if (!s || typeof s !== \"object\") {\n      return false;\n    }\n    if (!(\"publicKey\" in s && typeof s.publicKey === \"string\")) {\n      return false;\n    }\n    if (!(\"privateKey\" in s && typeof s.privateKey === \"string\")) {\n      return false;\n    }\n    if (!(\"signature\" in s && typeof s.signature === \"string\")) {\n      return false;\n    }\n    if (!(\"startTimestamp\" in s && typeof s.startTimestamp === \"number\")) {\n      return false;\n    }\n    if (!(\"durationDays\" in s && typeof s.durationDays === \"number\")) {\n      return false;\n    }\n    if (!(\"contractAddresses\" in s && Array.isArray(s.contractAddresses))) {\n      return false;\n    }\n    for (let i = 0; i < s.contractAddresses.length; ++i) {\n      if (typeof s.contractAddresses[i] !== \"string\") return false;\n      if (!s.contractAddresses[i].startsWith(\"0x\")) return false;\n    }\n    if (\n      !(\n        \"userAddress\" in s &&\n        typeof s.userAddress === \"string\" &&\n        s.userAddress.startsWith(\"0x\")\n      )\n    ) {\n      return false;\n    }\n    if (!(\"eip712\" in s && typeof s.eip712 === \"object\" && s.eip712 !== null)) {\n      return false;\n    }\n\n    // Partial type check\n    if (!(\"domain\" in s.eip712 && typeof s.eip712.domain === \"object\")) {\n      return false;\n    }\n    if (\n      !(\"primaryType\" in s.eip712 && typeof s.eip712.primaryType === \"string\")\n    ) {\n      return false;\n    }\n    if (!(\"message\" in s.eip712)) {\n      return false;\n    }\n    if (\n      !(\n        \"types\" in s.eip712 &&\n        typeof s.eip712.types === \"object\" &&\n        s.eip712.types !== null\n      )\n    ) {\n      return false;\n    }\n\n    return true;\n  }\n\n  toJSON() {\n    return {\n      publicKey: this.#publicKey,\n      privateKey: this.#privateKey,\n      signature: this.#signature,\n      startTimestamp: this.#startTimestamp,\n      durationDays: this.#durationDays,\n      userAddress: this.#userAddress,\n      contractAddresses: this.#contractAddresses,\n      eip712: this.#eip712,\n    };\n  }\n\n  static fromJSON(json: unknown) {\n    const data = typeof json === \"string\" ? JSON.parse(json) : json;\n    return new FhevmDecryptionSignature(data);\n  }\n\n  equals(s: FhevmDecryptionSignatureType) {\n    return s.signature === this.#signature;\n  }\n\n  isValid(): boolean {\n    return (\n      _timestampNow() < this.#startTimestamp + this.#durationDays * 24 * 60 * 60\n    );\n  }\n\n  async saveToGenericStringStorage(\n    storage: GenericStringStorage,\n    instance: FhevmInstance,\n    withPublicKey: boolean\n  ) {\n    try {\n      const value = JSON.stringify(this);\n\n      const storageKey = new FhevmDecryptionSignatureStorageKey(\n        instance,\n        this.#contractAddresses,\n        this.#userAddress,\n        withPublicKey ? this.#publicKey : undefined\n      );\n      await storage.setItem(storageKey.key, value);\n      console.log(\n        `signature saved! contracts=${this.#contractAddresses.length}`\n      );\n    } catch {\n      console.error(\n        `FhevmDecryptionSignature.saveToGenericStringStorage() failed!`\n      );\n    }\n  }\n\n  static async loadFromGenericStringStorage(\n    storage: GenericStringStorage,\n    instance: FhevmInstance,\n    contractAddresses: string[],\n    userAddress: string,\n    publicKey?: string\n  ): Promise<FhevmDecryptionSignature | null> {\n    try {\n      const storageKey = new FhevmDecryptionSignatureStorageKey(\n        instance,\n        contractAddresses,\n        userAddress,\n        publicKey\n      );\n\n      const result = await storage.getItem(storageKey.key);\n\n      if (!result) {\n        console.warn(`Could not load signature! key=${storageKey.key}`);\n        return null;\n      }\n\n      try {\n        const kps = FhevmDecryptionSignature.fromJSON(result);\n        if (!kps.isValid()) {\n          return null;\n        }\n\n        return kps;\n      } catch {\n        return null;\n      }\n    } catch {\n      console.error(\n        `FhevmDecryptionSignature.loadFromGenericStringStorage() failed!`\n      );\n      return null;\n    }\n  }\n\n  static async new(\n    instance: FhevmInstance,\n    contractAddresses: string[],\n    publicKey: string,\n    privateKey: string,\n    signer: ethers.Signer\n  ): Promise<FhevmDecryptionSignature | null> {\n    try {\n      const userAddress = (await signer.getAddress()) as `0x${string}`;\n      const startTimestamp = _timestampNow();\n      const durationDays = 365;\n      const eip712 = instance.createEIP712(\n        publicKey,\n        contractAddresses,\n        startTimestamp,\n        durationDays\n      );\n      const signature = await signer.signTypedData(\n        eip712.domain,\n        { UserDecryptRequestVerification: eip712.types.UserDecryptRequestVerification },\n        eip712.message\n      );\n      return new FhevmDecryptionSignature({\n        publicKey,\n        privateKey,\n        contractAddresses: contractAddresses as `0x${string}`[],\n        startTimestamp,\n        durationDays,\n        signature,\n        eip712: eip712 as EIP712Type,\n        userAddress,\n      });\n    } catch {\n      return null;\n    }\n  }\n\n  static async loadOrSign(\n    instance: FhevmInstance,\n    contractAddresses: string[],\n    signer: ethers.Signer,\n    storage: GenericStringStorage,\n    keyPair?: { publicKey: string; privateKey: string }\n  ): Promise<FhevmDecryptionSignature | null> {\n    const userAddress = (await signer.getAddress()) as `0x${string}`;\n\n    const cached: FhevmDecryptionSignature | null =\n      await FhevmDecryptionSignature.loadFromGenericStringStorage(\n        storage,\n        instance,\n        contractAddresses,\n        userAddress,\n        keyPair?.publicKey\n      );\n\n    if (cached) {\n      return cached;\n    }\n\n    const { publicKey, privateKey } = keyPair ?? instance.generateKeypair();\n\n    const sig = await FhevmDecryptionSignature.new(\n      instance,\n      contractAddresses,\n      publicKey,\n      privateKey,\n      signer\n    );\n\n    if (!sig) {\n      return null;\n    }\n\n    await sig.saveToGenericStringStorage(\n      storage,\n      instance,\n      Boolean(keyPair?.publicKey)\n    );\n\n    return sig;\n  }\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1009, "column": 0}, "map": {"version":3,"sources":["file:///E:/Spring/Zama/huangchen/cipher-wealth-main/cipher-wealth-main/frontend/hooks/useCipherWealth.tsx"],"sourcesContent":["import { useCallback, useEffect, useMemo, useRef, useState, RefObject } from \"react\";\nimport type { FhevmInstance } from \"../fhevm/fhevmTypes\";\nimport type { Eip1193Provider, JsonRpcSigner, ContractRunner } from \"ethers\";\nimport { Contract, ethers } from \"ethers\";\nimport { CipherWealth } from \"../abi/CipherWealth\";\nimport { CipherWealthAddresses } from \"../abi/CipherWealthAddresses\";\nimport type { GenericStringStorage } from \"../fhevm/GenericStringStorage\";\nimport { FhevmDecryptionSignature } from \"../fhevm/FhevmDecryptionSignature\";\n\ntype CipherWealthInfoType = {\n  abi: typeof CipherWealth.abi;\n  address?: `0x${string}`;\n  chainId?: number;\n  chainName?: string;\n};\n\nfunction getCipherWealthByChainId(chainId: number | undefined): CipherWealthInfoType {\n  if (!chainId) {\n    return { abi: CipherWealth.abi };\n  }\n\n  const entry =\n    CipherWealthAddresses[chainId.toString() as keyof typeof CipherWealthAddresses];\n\n  if (!entry || !(\"address\" in entry) || entry.address === ethers.ZeroAddress) {\n    return { abi: CipherWealth.abi, chainId };\n  }\n\n  return {\n    address: entry.address as `0x${string}` | undefined,\n    chainId: entry.chainId ?? chainId,\n    chainName: entry.chainName,\n    abi: CipherWealth.abi,\n  };\n}\n\ntype UseCipherWealthParams = {\n  instance: FhevmInstance | undefined;\n  fhevmDecryptionSignatureStorage: GenericStringStorage;\n  eip1193Provider: Eip1193Provider | undefined;\n  chainId: number | undefined;\n  ethersSigner: JsonRpcSigner | undefined;\n  ethersReadonlyProvider: ContractRunner | undefined;\n  sameChain: RefObject<(chainId: number | undefined) => boolean>;\n  sameSigner: RefObject<(ethersSigner: JsonRpcSigner | undefined) => boolean>;\n};\n\nexport function useCipherWealth({\n  instance,\n  fhevmDecryptionSignatureStorage,\n  eip1193Provider,\n  chainId,\n  ethersSigner,\n  ethersReadonlyProvider,\n  sameChain,\n  sameSigner,\n}: UseCipherWealthParams) {\n  const [balance, setBalance] = useState<string | null>(null);\n  const [clear, setClear] = useState<bigint | null>(null);\n  const [isDecrypted, setIsDecrypted] = useState<boolean>(false);\n  const [isRefreshing, setIsRefreshing] = useState<boolean>(false);\n  const [isDecrypting, setIsDecrypting] = useState<boolean>(false);\n  const [isOperating, setIsOperating] = useState<boolean>(false);\n  const [message, setMessage] = useState<string>(\"\");\n\n  const cipherWealthRef = useRef<CipherWealthInfoType | undefined>(undefined);\n\n  const cipherWealth = useMemo(() => {\n    const info = getCipherWealthByChainId(chainId);\n    cipherWealthRef.current = info;\n    if (!info.address) {\n      setMessage(`CipherWealth deployment not found for chainId=${chainId}.`);\n    }\n    return info;\n  }, [chainId]);\n\n  const isDeployed = useMemo(() => {\n    if (!cipherWealth) return null;\n    return Boolean(cipherWealth.address) && cipherWealth.address !== ethers.ZeroAddress;\n  }, [cipherWealth]);\n\n  const canGetBalance = Boolean(\n    instance &&\n      cipherWealth.address &&\n      ethersReadonlyProvider &&\n      ethersSigner &&\n      sameChain.current(chainId) &&\n      sameSigner.current(ethersSigner) &&\n      !isRefreshing,\n  );\n\n  const canDecrypt = Boolean(\n    instance &&\n      cipherWealth.address &&\n      balance &&\n      balance !== \"0x0000000000000000000000000000000000000000000000000000000000000000\" &&\n      eip1193Provider &&\n      ethersSigner &&\n      sameChain.current(chainId) &&\n      sameSigner.current(ethersSigner) &&\n      !isDecrypting &&\n      !isDecrypted,\n  );\n\n  const canOperate = Boolean(\n    instance && \n    cipherWealth.address && \n    eip1193Provider && \n    ethersSigner && \n    sameChain.current(chainId) && \n    sameSigner.current(ethersSigner) && \n    !isOperating,\n  );\n\n  // Refresh balance handle\n  const refreshBalance = useCallback(async () => {\n    if (!canGetBalance || !cipherWealth.address || !ethersSigner) return;\n\n    setIsRefreshing(true);\n    setMessage(\"Fetching encrypted balance...\");\n\n    try {\n      const userAddress = await ethersSigner.getAddress();\n      const contract = new Contract(cipherWealth.address, cipherWealth.abi, ethersReadonlyProvider!);\n      const balanceHandle = await contract.getBalance({ from: userAddress });\n      setBalance(balanceHandle);\n      setIsDecrypted(false);\n      setClear(null);\n      setMessage(\"Balance handle retrieved successfully\");\n    } catch (error: any) {\n      console.error(\"Failed to get balance:\", error);\n      setMessage(`Error: ${error.message || \"Failed to get balance\"}`);\n    } finally {\n      setIsRefreshing(false);\n    }\n  }, [canGetBalance, cipherWealth.address, cipherWealth.abi, ethersReadonlyProvider, ethersSigner]);\n\n  // Decrypt balance\n  const decryptBalance = useCallback(async () => {\n    if (!canDecrypt || !cipherWealth.address || !instance || !ethersSigner) return;\n\n    setIsDecrypting(true);\n    setMessage(\"Decrypting balance...\");\n\n    try {\n      const contractAddress = cipherWealth.address as `0x${string}`;\n\n      const sig = await FhevmDecryptionSignature.loadOrSign(\n        instance,\n        [contractAddress],\n        ethersSigner,\n        fhevmDecryptionSignatureStorage,\n      );\n\n      if (!sig) {\n        setMessage(\"Unable to build FHEVM decryption signature\");\n        return;\n      }\n\n      const res = await instance.userDecrypt(\n        [{ handle: balance!, contractAddress }],\n        sig.privateKey,\n        sig.publicKey,\n        sig.signature,\n        sig.contractAddresses,\n        sig.userAddress,\n        sig.startTimestamp,\n        sig.durationDays,\n      );\n\n      const clearValue = res[balance!];\n      const bigintValue = typeof clearValue === \"bigint\" ? clearValue : BigInt(clearValue);\n      setClear(bigintValue);\n      setIsDecrypted(true);\n      setMessage(`Decrypted balance: ${bigintValue.toString()}`);\n    } catch (error: any) {\n      console.error(\"Failed to decrypt balance:\", error);\n      setMessage(`Decryption error: ${error.message || \"Failed to decrypt\"}`);\n    } finally {\n      setIsDecrypting(false);\n    }\n  }, [canDecrypt, cipherWealth.address, instance, balance, ethersSigner, fhevmDecryptionSignatureStorage]);\n\n  // Deposit encrypted amount\n  const deposit = useCallback(\n    async (amount: number) => {\n      if (!canOperate || !cipherWealth.address) return;\n\n      setIsOperating(true);\n      setMessage(`Depositing ${amount}...`);\n\n      try {\n        const userAddress = await ethersSigner!.getAddress();\n        const contractAddress = cipherWealth.address as string;\n        const encryptedInput = await instance!.createEncryptedInput(contractAddress, userAddress);\n        encryptedInput.add64(amount);\n        const { handles, inputProof } = await encryptedInput.encrypt();\n\n        const contract = new Contract(contractAddress, cipherWealth.abi, ethersSigner!);\n        const tx = await contract.deposit(handles[0], inputProof);\n        await tx.wait();\n\n        setMessage(`Successfully deposited ${amount}`);\n        setIsDecrypted(false);\n        setClear(null);\n\n        // Auto-refresh balance after deposit\n        setTimeout(() => refreshBalance(), 1000);\n      } catch (error: any) {\n        console.error(\"Failed to deposit:\", error);\n        setMessage(`Deposit error: ${error.message || \"Failed to deposit\"}`);\n      } finally {\n        setIsOperating(false);\n      }\n    },\n    [canOperate, instance, cipherWealth.address, cipherWealth.abi, ethersSigner, refreshBalance],\n  );\n\n  // Withdraw encrypted amount\n  const withdraw = useCallback(\n    async (amount: number) => {\n      if (!canOperate) return;\n\n      setIsOperating(true);\n      setMessage(`Withdrawing ${amount}...`);\n\n      try {\n        const userAddress = await ethersSigner!.getAddress();\n        const contractAddress = cipherWealth.address as string;\n        const encryptedInput = await instance!.createEncryptedInput(contractAddress, userAddress);\n        encryptedInput.add64(amount);\n        const { handles, inputProof } = await encryptedInput.encrypt();\n\n        const contract = new Contract(contractAddress, cipherWealth.abi, ethersSigner!);\n        const tx = await contract.withdraw(handles[0], inputProof);\n        await tx.wait();\n\n        setMessage(`Successfully withdrew ${amount}`);\n        setIsDecrypted(false);\n        setClear(null);\n\n        // Auto-refresh balance after withdrawal\n        setTimeout(() => refreshBalance(), 1000);\n      } catch (error: any) {\n        console.error(\"Failed to withdraw:\", error);\n        setMessage(`Withdrawal error: ${error.message || \"Failed to withdraw\"}`);\n      } finally {\n        setIsOperating(false);\n      }\n    },\n    [canOperate, instance, cipherWealth.address, cipherWealth.abi, ethersSigner, refreshBalance],\n  );\n\n  return {\n    contractAddress: cipherWealth.address || null,\n    isDeployed,\n    balance,\n    clear,\n    isDecrypted,\n    isRefreshing,\n    isDecrypting,\n    isOperating,\n    canGetBalance,\n    canDecrypt,\n    canOperate,\n    message,\n    refreshBalance,\n    decryptBalance,\n    deposit,\n    withdraw,\n  };\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1228, "column": 0}, "map": {"version":3,"sources":["file:///E:/Spring/Zama/huangchen/cipher-wealth-main/cipher-wealth-main/frontend/components/ErrorNotDeployed.tsx"],"sourcesContent":["export function errorNotDeployed(chainId: number | undefined) {\n  return (\n    <div className=\"grid w-full gap-4 mx-auto font-semibold bg-none\">\n      <div className=\"col-span-full mx-20\">\n        <p className=\"text-4xl leading-relaxed\">\n          {\" \"}\n          <span className=\"font-mono bg-red-500\">Error</span>:{\" \"}\n          <span className=\"font-mono bg-white\">CipherWealth.sol</span> Contract\n          Not Deployed on{\" \"}\n          <span className=\"font-mono bg-white\">chainId={chainId}</span>{\" \"}\n          {chainId === 11155111 ? \"(Sepolia)\" : \"\"} or Deployment Address\n          Missing.\n        </p>\n        <p className=\"text-xl leading-relaxed mt-8\">\n          It appears that the{\" \"}\n          <span className=\"font-mono bg-white\">CipherWealth.sol</span> contract\n          has either not been deployed yet, or the deployment address is missing\n          from the ABI directory{\" \"}\n          <span className=\"font-mono bg-white\">frontend/abi</span>. To\n          deploy <span className=\"font-mono bg-white\">CipherWealth.sol</span> on\n          Sepolia, run the following command:\n        </p>\n        <p className=\"font-mono text-2xl leading-relaxed bg-black text-white p-4 mt-12\">\n          <span className=\"opacity-50 italic text-red-500\">\n            #from project root\n          </span>\n          <br />\n          npx hardhat deploy --network{\" \"}\n          {chainId === 11155111 ? \"sepolia\" : \"your-network-name\"}\n        </p>\n        <p className=\"text-xl leading-relaxed mt-12\">\n          Alternatively, switch to the local{\" \"}\n          <span className=\"font-mono bg-white\">Hardhat Node</span> using the\n          MetaMask browser extension.\n        </p>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;;AAAO,SAAS,iBAAiB,OAA2B;IAC1D,qBACE,0PAAC;QAAI,WAAU;kBACb,cAAA,0PAAC;YAAI,WAAU;;8BACb,0PAAC;oBAAE,WAAU;;wBACV;sCACD,0PAAC;4BAAK,WAAU;sCAAuB;;;;;;wBAAY;wBAAE;sCACrD,0PAAC;4BAAK,WAAU;sCAAqB;;;;;;wBAAuB;wBAC5C;sCAChB,0PAAC;4BAAK,WAAU;;gCAAqB;gCAAS;;;;;;;wBAAgB;wBAC7D,YAAY,WAAW,cAAc;wBAAG;;;;;;;8BAG3C,0PAAC;oBAAE,WAAU;;wBAA+B;wBACtB;sCACpB,0PAAC;4BAAK,WAAU;sCAAqB;;;;;;wBAAuB;wBAErC;sCACvB,0PAAC;4BAAK,WAAU;sCAAqB;;;;;;wBAAmB;sCACjD,0PAAC;4BAAK,WAAU;sCAAqB;;;;;;wBAAuB;;;;;;;8BAGrE,0PAAC;oBAAE,WAAU;;sCACX,0PAAC;4BAAK,WAAU;sCAAiC;;;;;;sCAGjD,0PAAC;;;;;wBAAK;wBACuB;wBAC5B,YAAY,WAAW,YAAY;;;;;;;8BAEtC,0PAAC;oBAAE,WAAU;;wBAAgC;wBACR;sCACnC,0PAAC;4BAAK,WAAU;sCAAqB;;;;;;wBAAmB;;;;;;;;;;;;;;;;;;AAMlE","debugId":null}},
    {"offset": {"line": 1384, "column": 0}, "map": {"version":3,"sources":["file:///E:/Spring/Zama/huangchen/cipher-wealth-main/cipher-wealth-main/frontend/components/CipherWealthPanel.tsx"],"sourcesContent":["\"use client\";\n\nimport { useState } from \"react\";\nimport { useFhevm } from \"../fhevm/useFhevm\";\nimport { useInMemoryStorage } from \"../hooks/useInMemoryStorage\";\nimport { useMetaMaskEthersSigner } from \"../hooks/metamask/useMetaMaskEthersSigner\";\nimport { useCipherWealth } from \"@/hooks/useCipherWealth\";\nimport { errorNotDeployed } from \"./ErrorNotDeployed\";\nimport { \n  Wallet, Lock, Unlock, RefreshCw, ArrowDownToLine, ArrowUpFromLine, \n  Shield, Eye, EyeOff, Sparkles, TrendingUp, Activity, Zap, \n  CheckCircle, Clock, AlertCircle\n} from \"lucide-react\";\n\nexport const CipherWealthPanel = () => {\n  const { storage: fhevmDecryptionSignatureStorage } = useInMemoryStorage();\n  const {\n    provider,\n    chainId,\n    accounts,\n    isConnected,\n    connect,\n    ethersSigner,\n    ethersReadonlyProvider,\n    sameChain,\n    sameSigner,\n    initialMockChains,\n  } = useMetaMaskEthersSigner();\n\n  const [depositAmount, setDepositAmount] = useState<string>(\"100\");\n  const [withdrawAmount, setWithdrawAmount] = useState<string>(\"50\");\n  const [showBalance, setShowBalance] = useState(false);\n\n  // FHEVM instance\n  const {\n    instance: fhevmInstance,\n    status: fhevmStatus,\n  } = useFhevm({\n    provider,\n    chainId,\n    initialMockChains,\n    enabled: true,\n  });\n\n  // CipherWealth contract hook\n  const cipherWealth = useCipherWealth({\n    instance: fhevmInstance,\n    fhevmDecryptionSignatureStorage,\n    eip1193Provider: provider,\n    chainId,\n    ethersSigner,\n    ethersReadonlyProvider,\n    sameChain,\n    sameSigner,\n  });\n\n  if (!isConnected) {\n    return (\n      <div className=\"max-w-lg mx-auto animate-fade-in\">\n        <div className=\"card-premium p-10 text-center relative overflow-hidden\">\n          {/* Decorative elements */}\n          <div className=\"absolute top-4 right-4 text-3xl opacity-30 animate-float\"></div>\n          <div className=\"absolute bottom-4 left-4 text-2xl opacity-20 animate-float\" style={{ animationDelay: '1s' }}></div>\n          \n          <div className=\"relative z-10\">\n            <div className=\"flex justify-center mb-6\">\n              <div className=\"relative\">\n                <div className=\"w-24 h-24 rounded-2xl bg-gradient-to-br from-primary to-accent flex items-center justify-center animate-pulse-glow\">\n                  <Wallet className=\"w-12 h-12 text-primary-foreground\" />\n                </div>\n                <div className=\"absolute -bottom-2 -right-2 w-10 h-10 bg-card rounded-xl flex items-center justify-center border border-border\">\n                  <span className=\"text-xl\"></span>\n                </div>\n              </div>\n            </div>\n            \n            <h2 className=\"text-3xl font-bold gradient-text mb-3\">\n              Welcome to Cipher Wealth\n            </h2>\n            <p className=\"text-muted-foreground mb-8 text-lg\">\n              Your gateway to encrypted wealth management \n            </p>\n            \n            <button \n              className=\"btn-premium w-full text-lg py-4 flex items-center justify-center gap-3\"\n              onClick={connect}\n            >\n              <Wallet className=\"w-5 h-5\" />\n              Connect Wallet\n              <Sparkles className=\"w-5 h-5\" />\n            </button>\n            \n            <div className=\"mt-8 grid grid-cols-3 gap-4\">\n              <div className=\"p-3 rounded-xl bg-muted/30 border border-border/50\">\n                <Shield className=\"w-5 h-5 text-primary mx-auto mb-2\" />\n                <p className=\"text-xs text-muted-foreground\">FHE Encrypted</p>\n              </div>\n              <div className=\"p-3 rounded-xl bg-muted/30 border border-border/50\">\n                <Lock className=\"w-5 h-5 text-accent mx-auto mb-2\" />\n                <p className=\"text-xs text-muted-foreground\">100% Private</p>\n              </div>\n              <div className=\"p-3 rounded-xl bg-muted/30 border border-border/50\">\n                <Zap className=\"w-5 h-5 text-success mx-auto mb-2\" />\n                <p className=\"text-xs text-muted-foreground\">Instant Ops</p>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (cipherWealth.isDeployed === false) {\n    return errorNotDeployed(chainId);\n  }\n\n  return (\n    <div className=\"space-y-6 animate-fade-in\">\n      {/* Hero Balance Card */}\n      <div className=\"card-highlight rounded-2xl p-8 relative overflow-hidden hover-lift\">\n        {/* Background decoration */}\n        <div className=\"absolute top-0 right-0 w-64 h-64 bg-primary/10 rounded-full blur-[80px] -translate-y-1/2 translate-x-1/2\" />\n        <div className=\"absolute bottom-0 left-0 w-48 h-48 bg-accent/10 rounded-full blur-[60px] translate-y-1/2 -translate-x-1/2\" />\n        \n        <div className=\"relative z-10\">\n          <div className=\"flex items-center justify-between mb-6\">\n            <div className=\"flex items-center gap-3\">\n              <div className=\"w-12 h-12 rounded-xl bg-gradient-to-br from-primary/20 to-accent/20 flex items-center justify-center border border-primary/30\">\n                <Wallet className=\"w-6 h-6 text-primary\" />\n              </div>\n              <div>\n                <h2 className=\"text-lg font-semibold text-foreground flex items-center gap-2\">\n                   Your Encrypted Balance\n                </h2>\n                <p className=\"text-sm text-muted-foreground\">Secured by FHE Technology</p>\n              </div>\n            </div>\n            \n            <div className=\"flex items-center gap-2\">\n              <button\n                className=\"btn-secondary flex items-center gap-2\"\n                onClick={() => setShowBalance(!showBalance)}\n              >\n                {showBalance ? <EyeOff className=\"w-4 h-4\" /> : <Eye className=\"w-4 h-4\" />}\n                {showBalance ? \"Hide\" : \"Show\"}\n              </button>\n              <button\n                className=\"btn-secondary flex items-center gap-2\"\n                disabled={!cipherWealth.canGetBalance}\n                onClick={cipherWealth.refreshBalance}\n              >\n                <RefreshCw className={`w-4 h-4 ${cipherWealth.isRefreshing ? \"animate-spin\" : \"\"}`} />\n                Refresh\n              </button>\n            </div>\n          </div>\n\n          {/* Balance Display */}\n          <div className=\"mb-6\">\n            <div className=\"flex items-baseline gap-4\">\n              <span className=\"text-6xl font-bold gradient-text\">\n                {cipherWealth.isDecrypted && showBalance \n                  ? cipherWealth.clear?.toString() || \"0\" \n                  : \"\"}\n              </span>\n              <span className=\"text-2xl text-muted-foreground\">tokens</span>\n              {cipherWealth.isDecrypted && (\n                <span className=\"ml-auto flex items-center gap-2 text-success bg-success/10 px-3 py-1 rounded-full text-sm\">\n                  <CheckCircle className=\"w-4 h-4\" />\n                  Decrypted\n                </span>\n              )}\n            </div>\n            \n            <div className=\"mt-4 p-4 rounded-xl bg-muted/30 border border-border/50\">\n              <p className=\"text-xs text-muted-foreground mb-1 flex items-center gap-2\">\n                <Lock className=\"w-3 h-3\" />\n                Encrypted Handle (on-chain)\n              </p>\n              <p className=\"font-mono text-xs break-all text-foreground/70\">\n                {cipherWealth.balance || \"Fetching encrypted balance...\"}\n              </p>\n            </div>\n          </div>\n\n          {/* Decrypt Button */}\n          <button\n            className={`btn-premium w-full flex items-center justify-center gap-3 py-4 ${\n              cipherWealth.isDecrypted ? 'bg-success hover:bg-success/90' : ''\n            }`}\n            disabled={!cipherWealth.canDecrypt}\n            onClick={cipherWealth.decryptBalance}\n          >\n            {cipherWealth.isDecrypting ? (\n              <>\n                <RefreshCw className=\"w-5 h-5 animate-spin\" />\n                <span>Decrypting via FHE...</span>\n                <span className=\"text-lg\"></span>\n              </>\n            ) : cipherWealth.isDecrypted ? (\n              <>\n                <Unlock className=\"w-5 h-5\" />\n                <span>Balance Decrypted</span>\n                <span className=\"text-lg\"></span>\n              </>\n            ) : (\n              <>\n                <Lock className=\"w-5 h-5\" />\n                <span>Decrypt Balance</span>\n                <span className=\"text-lg\"></span>\n              </>\n            )}\n          </button>\n        </div>\n      </div>\n\n      {/* Operations Grid */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\n        {/* Deposit Card */}\n        <div className=\"card-premium p-6 hover-lift animate-slide-up\" style={{ animationDelay: '0.1s' }}>\n          <div className=\"flex items-center gap-3 mb-6\">\n            <div className=\"w-12 h-12 rounded-xl bg-success/10 flex items-center justify-center border border-success/30\">\n              <ArrowDownToLine className=\"w-6 h-6 text-success\" />\n            </div>\n            <div>\n              <h3 className=\"text-xl font-bold text-foreground flex items-center gap-2\">\n                 Deposit\n              </h3>\n              <p className=\"text-sm text-muted-foreground\">Add funds to your vault</p>\n            </div>\n          </div>\n          \n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-muted-foreground mb-2 flex items-center gap-2\">\n                <span></span> Amount to Deposit\n              </label>\n              <div className=\"relative\">\n                <input\n                  type=\"number\"\n                  className=\"input-premium w-full pr-20\"\n                  value={depositAmount}\n                  onChange={(e) => setDepositAmount(e.target.value)}\n                  placeholder=\"Enter amount\"\n                  min=\"1\"\n                />\n                <span className=\"absolute right-4 top-1/2 -translate-y-1/2 text-sm text-muted-foreground\">\n                  tokens\n                </span>\n              </div>\n            </div>\n            \n            {/* Quick amounts */}\n            <div className=\"flex gap-2\">\n              {[50, 100, 500, 1000].map((amount) => (\n                <button\n                  key={amount}\n                  className=\"flex-1 py-2 rounded-lg bg-muted/50 border border-border/50 text-sm font-medium hover:border-success/50 hover:bg-success/5 transition-all\"\n                  onClick={() => setDepositAmount(amount.toString())}\n                >\n                  {amount}\n                </button>\n              ))}\n            </div>\n            \n            <button\n              className=\"btn-premium w-full flex items-center justify-center gap-3 bg-success hover:bg-success/90\"\n              disabled={!cipherWealth.canOperate || !depositAmount || Number(depositAmount) <= 0}\n              onClick={() => cipherWealth.deposit(Number(depositAmount))}\n            >\n              {cipherWealth.isOperating ? (\n                <>\n                  <RefreshCw className=\"w-5 h-5 animate-spin\" />\n                  <span>Processing...</span>\n                  <span></span>\n                </>\n              ) : (\n                <>\n                  <ArrowDownToLine className=\"w-5 h-5\" />\n                  <span>Deposit Now</span>\n                  <span></span>\n                </>\n              )}\n            </button>\n          </div>\n        </div>\n\n        {/* Withdraw Card */}\n        <div className=\"card-premium p-6 hover-lift animate-slide-up\" style={{ animationDelay: '0.2s' }}>\n          <div className=\"flex items-center gap-3 mb-6\">\n            <div className=\"w-12 h-12 rounded-xl bg-accent/10 flex items-center justify-center border border-accent/30\">\n              <ArrowUpFromLine className=\"w-6 h-6 text-accent\" />\n            </div>\n            <div>\n              <h3 className=\"text-xl font-bold text-foreground flex items-center gap-2\">\n                 Withdraw\n              </h3>\n              <p className=\"text-sm text-muted-foreground\">Retrieve your funds</p>\n            </div>\n          </div>\n          \n          <div className=\"space-y-4\">\n            <div>\n              <label className=\"block text-sm font-medium text-muted-foreground mb-2 flex items-center gap-2\">\n                <span></span> Amount to Withdraw\n              </label>\n              <div className=\"relative\">\n                <input\n                  type=\"number\"\n                  className=\"input-premium w-full pr-20\"\n                  value={withdrawAmount}\n                  onChange={(e) => setWithdrawAmount(e.target.value)}\n                  placeholder=\"Enter amount\"\n                  min=\"1\"\n                />\n                <span className=\"absolute right-4 top-1/2 -translate-y-1/2 text-sm text-muted-foreground\">\n                  tokens\n                </span>\n              </div>\n            </div>\n            \n            {/* Quick amounts */}\n            <div className=\"flex gap-2\">\n              {[25, 50, 100, 'Max'].map((amount) => (\n                <button\n                  key={amount}\n                  className=\"flex-1 py-2 rounded-lg bg-muted/50 border border-border/50 text-sm font-medium hover:border-accent/50 hover:bg-accent/5 transition-all\"\n                  onClick={() => {\n                    if (amount === 'Max' && cipherWealth.clear) {\n                      setWithdrawAmount(cipherWealth.clear.toString());\n                    } else if (typeof amount === 'number') {\n                      setWithdrawAmount(amount.toString());\n                    }\n                  }}\n                >\n                  {amount}\n                </button>\n              ))}\n            </div>\n            \n            <button\n              className=\"btn-premium w-full flex items-center justify-center gap-3\"\n              style={{ background: 'linear-gradient(135deg, hsl(var(--accent)), hsl(35 93% 48%))' }}\n              disabled={!cipherWealth.canOperate || !withdrawAmount || Number(withdrawAmount) <= 0}\n              onClick={() => cipherWealth.withdraw(Number(withdrawAmount))}\n            >\n              {cipherWealth.isOperating ? (\n                <>\n                  <RefreshCw className=\"w-5 h-5 animate-spin\" />\n                  <span>Processing...</span>\n                  <span></span>\n                </>\n              ) : (\n                <>\n                  <ArrowUpFromLine className=\"w-5 h-5\" />\n                  <span>Withdraw Now</span>\n                  <span></span>\n                </>\n              )}\n            </button>\n          </div>\n        </div>\n      </div>\n\n      {/* Status Message */}\n      {cipherWealth.message && (\n        <div className=\"card-premium p-4 animate-scale-in border-l-4 border-primary\">\n          <div className=\"flex items-center gap-3\">\n            <Activity className=\"w-5 h-5 text-primary animate-pulse\" />\n            <p className=\"text-sm text-foreground font-mono\">{cipherWealth.message}</p>\n          </div>\n        </div>\n      )}\n\n      {/* Contract Info */}\n      <div className=\"card-premium p-6 animate-slide-up\" style={{ animationDelay: '0.3s' }}>\n        <h3 className=\"text-lg font-bold text-foreground mb-6 flex items-center gap-2\">\n          <Shield className=\"w-5 h-5 text-primary\" />\n          Contract Information\n          <span className=\"text-lg\"></span>\n        </h3>\n        \n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n          <div className=\"p-4 rounded-xl bg-muted/30 border border-border/50 hover:border-primary/30 transition-colors\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <span className=\"text-lg\"></span>\n              <p className=\"text-sm text-muted-foreground\">Chain ID</p>\n            </div>\n            <p className=\"font-mono font-bold text-xl text-foreground\">{chainId}</p>\n          </div>\n          \n          <div className=\"p-4 rounded-xl bg-muted/30 border border-border/50 hover:border-primary/30 transition-colors\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <span className=\"text-lg\"></span>\n              <p className=\"text-sm text-muted-foreground\">FHEVM Status</p>\n            </div>\n            <p className=\"font-semibold text-xl text-foreground flex items-center gap-2\">\n              {fhevmStatus === 'created' ? (\n                <>\n                  <span className=\"w-2 h-2 bg-success rounded-full animate-pulse\" />\n                  <span className=\"text-success\">Active</span>\n                </>\n              ) : (\n                <>\n                  <Clock className=\"w-4 h-4 text-accent\" />\n                  <span className=\"text-accent\">{fhevmStatus}</span>\n                </>\n              )}\n            </p>\n          </div>\n          \n          <div className=\"p-4 rounded-xl bg-muted/30 border border-border/50 hover:border-primary/30 transition-colors md:col-span-2\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <span className=\"text-lg\"></span>\n              <p className=\"text-sm text-muted-foreground\">Contract Address</p>\n            </div>\n            <p className=\"font-mono text-sm break-all text-foreground\">{cipherWealth.contractAddress}</p>\n          </div>\n          \n          <div className=\"p-4 rounded-xl bg-muted/30 border border-border/50 hover:border-primary/30 transition-colors md:col-span-2\">\n            <div className=\"flex items-center gap-2 mb-2\">\n              <span className=\"text-lg\"></span>\n              <p className=\"text-sm text-muted-foreground\">Your Address</p>\n            </div>\n            <p className=\"font-mono text-sm break-all text-foreground\">{accounts?.[0] || \"N/A\"}</p>\n          </div>\n        </div>\n      </div>\n\n      {/* Features Section */}\n      <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 animate-slide-up\" style={{ animationDelay: '0.4s' }}>\n        <div className=\"card-premium p-5 text-center hover-lift\">\n          <div className=\"text-3xl mb-3\"></div>\n          <h4 className=\"font-semibold text-foreground mb-1\">End-to-End Encrypted</h4>\n          <p className=\"text-xs text-muted-foreground\">Your balance is never exposed on-chain</p>\n        </div>\n        <div className=\"card-premium p-5 text-center hover-lift\">\n          <div className=\"text-3xl mb-3\"></div>\n          <h4 className=\"font-semibold text-foreground mb-1\">Instant Operations</h4>\n          <p className=\"text-xs text-muted-foreground\">Fast deposits and withdrawals</p>\n        </div>\n        <div className=\"card-premium p-5 text-center hover-lift\">\n          <div className=\"text-3xl mb-3\"></div>\n          <h4 className=\"font-semibold text-foreground mb-1\">Zama FHE Powered</h4>\n          <p className=\"text-xs text-muted-foreground\">Industry-leading encryption</p>\n        </div>\n      </div>\n    </div>\n  );\n};\n"],"names":[],"mappings":"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","debugId":null}}]
}